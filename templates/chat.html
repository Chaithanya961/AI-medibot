<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medibot | Intelligence for Health</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root { 
            --brand-primary: #10b981; /* Emerald */
            --brand-dark: #0f172a;    /* Slate */
            --brand-light: #f8fafc;   /* background */
        }
        
        body { font-family: 'Inter', sans-serif; background-color: var(--brand-light); color: var(--brand-dark); margin: 0; }

        /* NAVBAR */
        .navbar { background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); padding: 1.2rem 8%; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .navbar-brand { font-weight: 800; color: var(--brand-dark) !important; font-size: 1.5rem; }

        /* STARTUP HERO */
        .hero { padding: 120px 8% 80px 8%; background: radial-gradient(circle at top right, #e0f2fe, #f8fafc); }
        .hero h1 { font-weight: 800; font-size: 3.5rem; letter-spacing: -2px; line-height: 1.1; }
        .btn-startup { background: var(--brand-dark); color: white; padding: 14px 30px; border-radius: 12px; font-weight: 600; border: none; transition: 0.3s; }
        .btn-startup:hover { transform: translateY(-2px); opacity: 0.9; }

        /* DYNAMIC NEWS SECTION */
        .news-section { padding: 80px 8%; background: #fff; }
        .news-card { 
            border: 1px solid rgba(0,0,0,0.05); border-radius: 20px; 
            padding: 25px; background: white; transition: 0.3s; height: 100%; 
            display: flex; flex-direction: column;
        }
        .news-card:hover { border-color: var(--brand-primary); transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .badge-new { background: #d1fae5; color: #065f46; font-size: 11px; font-weight: 700; padding: 4px 10px; border-radius: 6px; }

        /* CHAT WIDGET (FIXED OVERLAP & ALIGNMENT) */
        #chat-toggle {
            position: fixed; bottom: 30px; right: 30px;
            width: 65px; height: 65px; border-radius: 20px;
            background: var(--brand-dark); color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; cursor: pointer; z-index: 2000; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        #chat-widget {
            position: fixed; bottom: 110px; right: 30px;
            width: 400px; height: 600px;
            background: white; border-radius: 28px;
            display: none; flex-direction: column; /* FORCED FLEX FOR ALIGNMENT */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            z-index: 1999; overflow: hidden; border: 1px solid rgba(0,0,0,0.05);
        }

        .chat-header { background: var(--brand-dark); padding: 22px; color: white; display: flex; align-items: center; flex-shrink: 0; }
        .msg_card_body { flex: 1 1 auto; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; background: #fff; }
        .card-footer { padding: 18px 24px; background: white; border-top: 1px solid #f1f5f9; flex-shrink: 0; }

        /* BUBBLES */
        .msg_cotainer, .msg_cotainer_send { padding: 12px 18px; border-radius: 18px; font-size: 0.95rem; margin-bottom: 20px; max-width: 85%; line-height: 1.5; }
        .msg_cotainer { background: #f1f5f9; color: var(--brand-dark); align-self: flex-start; border-bottom-left-radius: 4px; }
        .msg_cotainer_send { background: var(--brand-primary); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        
        .chat-input { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 14px; padding: 12px 16px; width: 100%; transition: 0.3s; }
        .chat-input:focus { outline: none; border-color: var(--brand-primary); }

        /* FOOTER */
        footer { background: #0f172a; color: #94a3b8; padding: 80px 8% 40px 8%; }
        footer h5 { color: #fff; font-weight: 800; letter-spacing: -1px; }
        .disclaimer-box { background: #1e293b; color: #cbd5e1; border-radius: 16px; padding: 20px; }
        /* Custom Scrollbar Styling for a Startup Look */
    .scroll-container {
        display: flex;
        overflow-x: auto;
        gap: 24px;
        padding: 20px 8% 40px 8%; /* Matches your page padding */
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch; /* Smooth swipe on iOS */
    }

    /* Hide scrollbar for a cleaner UI (optional) */
    .scroll-container::-webkit-scrollbar {
        height: 6px;
    }
    .scroll-container::-webkit-scrollbar-thumb {
        background: var(--brand-primary);
        border-radius: 10px;
    }
    .scroll-container::-webkit-scrollbar-track {
        background: #f1f5f9;
    }

    /* Force cards to maintain their width in the scroll row */
    .scroll-item {
        flex: 0 0 350px; /* Fixed width for each news card */
        max-width: 350px;
    }

    @media (max-width: 768px) {
        .scroll-item { flex: 0 0 280px; } /* Slightly narrower cards on mobile */
        .scroll-container { padding-left: 5%; padding-right: 5%; }
    }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg sticky-top">
        <a class="navbar-brand" href="/">MEDIBOT<span class="text-success">.</span></a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ml-auto align-items-center">
                <li class="nav-item"><a class="nav-link" href="/health-centers">Facilities</a></li>
                <li class="nav-item"><a class="nav-link" href="/about-ai">About AI</a></li>
                <li class="nav-item"><button class="btn-startup ml-2" onclick="$('#chat-widget').css('display', 'flex').hide().fadeIn()">Launch App</button></li>
            </ul>
        </div>
    </nav>

    <section class="hero">
        <div class="container-fluid text-center text-lg-left">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1>Intelligence for a healthier life.</h1>
                    <p class="text-muted">Clinical-grade medical guidance powered by advanced RAG technology and curated knowledge bases.</p>
                    <button class="btn-startup" onclick="$('#chat-widget').css('display', 'flex').hide().fadeIn()">Consult Assistant</button>
                </div>
                <div class="col-lg-6 d-none d-lg-block text-center">
                    <img src="https://cdn-icons-png.flaticon.com/512/387/387569.png" style="width: 45%; opacity: 0.1; filter: grayscale(1);">
                </div>
            </div>
        </div>
    </section>

    <section class="news-section py-5 bg-white">
        <div class="container-fluid px-0">
        <h2 class="font-weight-800 mb-4" style="letter-spacing:-1px; padding-left: 8%;">Ecosystem Updates</h2>
        
        <div class="scroll-container">
            {% for article in articles %}
            <div class="scroll-item">
                <div class="news-card">
                    {% if article.urlToImage %}
                    <img src="{{ article.urlToImage }}" class="img-fluid rounded mb-3" style="height: 180px; width: 100%; object-fit: cover;">
                    {% endif %}
                    <div class="mb-2"><span class="badge-new">LIVE HEALTH NEWS</span></div>
                    <h5 class="font-weight-bold" style="font-size: 1.1rem;">{{ article.title[:60] }}...</h5>
                    <p class="text-muted small flex-grow-1">{{ article.description[:90] if article.description else 'Latest medical update from our global network.' }}...</p>
                    <a href="{{ article.url }}" target="_blank" class="font-weight-bold text-dark mt-auto" style="text-decoration:none; font-size: 0.9rem;">Read Full Story →</a>
                </div>
            </div>
            {% else %}
            <div class="w-100 text-center py-5">
                <p class="text-muted">No live updates currently available. Check back soon for medical breakthroughs.</p>
            </div>
            {% endfor %}
        </div>
</section>

    <footer>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-4 mb-5">
                    <h5>MEDIBOT.</h5>
                    <p class="small">Advancing healthcare accessibility through secure, RAG-powered intelligence.</p>
                </div>
                <div class="col-md-2 mb-5">
                    <h6 class="text-white small font-weight-bold mb-3">PLATFORM</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-2"><a href="/health-centers" class="text-reset">Facilities</a></li>
                        <li class="mb-2"><a href="/about-ai" class="text-reset">RAG Technology</a></li>
                    </ul>
                </div>
                <div class="col-md-6 mb-5 text-md-right">
                    <h6 class="text-white small font-weight-bold mb-3">SUPPORT</h6>
                    <p class="small">support@medibot.ai | +1 (555) 010-9988</p>
                </div>
            </div>
            
            <div class="border-top border-secondary pt-5 mt-4">
                <div class="disclaimer-box">
                    <p class="small mb-0 text-center">
                        <strong>Medical Disclaimer:</strong> This AI provides informational content only. It is <strong>not</strong> a substitute for professional medical advice, diagnosis, or treatment. Always consult a qualified healthcare provider for medical concerns.
                    </p>
                </div>
                <p class="text-center small mt-4">© 2026 Medibot AI Intelligence. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div id="chat-toggle"><i class="fas fa-plus"></i></div>

    <div id="chat-widget">
        <div class="chat-header">
            <h6 class="mb-0 font-weight-bold">Assistant AI</h6>
            <i class="fas fa-times ml-auto" style="cursor:pointer;" onclick="$('#chat-widget').fadeOut()"></i>
        </div>
        <div id="messageFormeight" class="msg_card_body">
            <div class="msg_cotainer">Hello. Describe your symptoms for a real-time clinical analysis.</div>
        </div>
        <div class="card-footer">
            <form id="messageArea" class="d-flex align-items-center">
                <input type="text" id="text" name="msg" placeholder="Describe symptoms..." class="chat-input" required/>
                <button type="submit" class="btn text-primary ml-2"><i class="fas fa-paper-plane"></i></button>
            </form>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            // Smooth Toggle with Flex check
            $("#chat-toggle").on("click", function() {
                if ($("#chat-widget").is(":visible")) { $("#chat-widget").fadeOut(); } 
                else { $("#chat-widget").css("display", "flex").hide().fadeIn(); }
            });

            function scrollToBottom() {
                var chatBody = $("#messageFormeight");
                chatBody.scrollTop(chatBody[0].scrollHeight);
            }

            $("#messageArea").on("submit", function(e) {
                e.preventDefault();
                var rawText = $("#text").val();
                $("#messageFormeight").append(`<div class="msg_cotainer_send">${rawText}</div>`);
                $("#text").val("");
                scrollToBottom();
                
                var tid = "thinking-" + Date.now();
                $("#messageFormeight").append(`<div id="${tid}" class="msg_cotainer"><i class="fas fa-circle-notch fa-spin"></i> Analyzing...</div>`);
                scrollToBottom();
                
                $.ajax({ data: { msg: rawText }, type: "POST", url: "/get" }).done(function(data) {
                    $("#" + tid).remove();
                    $("#messageFormeight").append(`<div class="msg_cotainer">${marked.parse(data)}</div>`);
                    scrollToBottom();
                });
            });
        });
    </script>
</body>
</html>